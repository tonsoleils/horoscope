# horoscope
## Цель
Создать телеграм-бота, с помощью которого пользователь сможет сгенерировать гороскоп для интересующего знака зодиака.
## Задачи 
1) выбрать набор данных и модель
2) получение датасета
3) обработка данных
4) дообучение модели
5) сохранение модели
6) реализация телеграм-бота

## Описание
Проект включает себя две составляющие: реализиация дообучения модели и реализация телеграм-бота.

### horo_train_model_colab.ipynb
Данный файл содержит реализацию дообучения модели gpt3-small от Сбербанка на датасете, состоящим из гороскопов. Обучение производилось в google colab с импользованием графического ускорителя.

### bot/generate.py
В данной программе реализована функция `generate_horoscope(sign: str, tok, model)`, которая принимает sign - знак зодиака, tok - токенизатор, model - предзагруженную модель и генирирует гороскоп.

### bot/config.py
Данный файл содержит конфиг бота.

### bot/bot.py
Данный файл содержит реализацию бота с двумя хэндлерами: `/start` и `/generate <sign>`. При `/start` бот отправляет приветственное сообщение, при `/generate <sign>` генерирует гороскоп по знаку зодиака <sign>.

## Использование
1) Необходимо предобучить модель. Для этого нужно поэтапно запустить все ячейки в `horo_train_model_colab.ipynb`. В результате в корневой папке создаться папка `model`, в которой находится обученная модель.
2) Заполнить конфинг в `bot/config.py` токеном бота.
3) Запустить бота, выполнив: 
```Python
python bot.py
```
Бот будет доступен по никнейму, который соответствует токену.
